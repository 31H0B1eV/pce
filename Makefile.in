# Makefile

srcdir := @srcdir@
topdir := @top_srcdir@
subdir := src
reldir := .

include $(reldir)/config.inc


ROMBIN := et4000.rom \
	genoa.rom \
	ibmega.rom \
	pce-bios.rom \
	pce-ega.rom \
	t9000b.rom

DCL := Makefile config.inc config.log config.status configure rules.inc

DIST := AUTHORS \
	COPYING \
	ChangeLog \
	INSTALL \
	Makefile.in \
	NEWS \
	README \
	TODO \
	autogen.sh \
	config.guess \
	config.inc.in \
	config.sub \
	configure \
	configure.in \
	install-sh \
	rules.inc.in

include $(reldir)/rules.inc


all:


install:
	$(QR)for f in $(ROMBIN) ; do \
		src=$(srcdir)/contrib/rom/ibmpc/$$f ; \
		dst=$(DESTDIR)$(datdir)/$$f ; \
		test -f "$$dst" && continue ; \
		test -f "$$src" || continue ; \
		test x$(V) != x1 && echo "  CP     $$f" ; \
		$(INSTALL) -d -m 755 "$(DESTDIR)$(datdir)" ; \
		$(INSTALL) -m 644 "$$src" "$$dst" ; \
	done


dist:
	$(QR)if test -d "$(srcdir)/contrib" ; then \
		( cd "$(srcdir)/contrib" && find . -type f -print ) |\
		while read src ; do \
			test -f "$(distdir)/contrib/$$src" && continue ; \
			test x$(V) != x1 && echo "  CP     $$src" ; \
			dir=`dirname "$(distdir)/contrib/$$src"` ; \
			mkdir -p "$$dir" ; \
			cp -p "$(srcdir)/contrib/$$src" "$$dir" ; \
		done ; \
	fi
	$(QP)echo "  GEN    version"
	$(QR)echo "pce  $(PCE_VERSION_MAJ) $(PCE_VERSION_MIN) $(PCE_VERSION_MIC)  $(PCE_VERSION_STR)" \
		> "$(distdir)/version"
	$(QP)echo "  TAR    $(distdir).tar"
	$(QR)( cd "$(distdir)"/.. && \
		tar -cvf "$(distdir).tar" `basename "$(distdir)"` > /dev/null )
	$(QP)echo "  GZIP   $(distdir).tar.gz"
	$(QR)gzip -9 "$(distdir).tar"
