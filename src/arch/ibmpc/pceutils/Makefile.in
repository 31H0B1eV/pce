# Makefile
# $Id: Makefile.in,v 1.1 2003/12/20 01:01:36 hampa Exp $

srcdir := @srcdir@
topdir := @top_srcdir@
subdir :=
reldir := ../../../..


include $(reldir)/Makefile.inc


BASECOM	:= pceboot pcecpu pceexit pceint28 pcestop pcetime pcever
BASESYS := pceemm pcehimem

SRC	:= $(foreach f,$(BASECOM) $(BASESYS),$(f).asm)

HDR	:=
HDR_EXT	:= $(topdir)/src/ibmpc/pce.inc $(reldir)/src/config.inc

MAN	:=

BIN	:= $(foreach f,$(BASECOM),$(f).com)
BIN	+= $(foreach f,$(BASESYS),$(f).sys)

SDP	:= Makefile $(HDR) $(HDR_EXT)
BDP	:= Makefile $(OBJ) $(OBJ_EXT)


all: $(BIN)


clean:
	rm -f $(OBJ) $(BIN)


install:
	$(INSTALL) -d -m 755 $(datdir)/pce/pceutils
	$(INSTALL) -m 644 $(BIN) $(datdir)/pce/pceutils


%.com: %.asm
	nasm -O2 -I$(reldir)/src -I$(topdir)/src/arch/ibmpc -f bin $< -o $@

%.sys: %.asm
	nasm -O2 -I$(reldir)/src -I$(topdir)/src/arch/ibmpc -f bin $< -o $@


pceboot.com:	pceboot.asm
pcecpu.com:	pcecpu.asm
pceemm.sys:	pceemm.asm
pceexit.com:	pceexit.asm
pcehimem.sys:	pcehimem.asm
pceint28.sys:	pceint28.asm
pcestop.com:	pcestop.asm
pcetime.com:	pcetime.asm
pcever.com:	pcever.asm
