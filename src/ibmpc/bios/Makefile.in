# Makefile
# $Id: Makefile.in,v 1.3 2003/09/13 18:12:17 hampa Exp $

srcdir := @srcdir@
topdir := @top_srcdir@
subdir :=
reldir := ../../..

include $(reldir)/Makefile.inc


SRC	:= basic.asm bios.asm pce.asm

OBJ	:= basic.bin bios.bin pce.bin
OBJ_EXT	:=

HDR	:=
HDR_EXT	:=

MAN	:=

ifeq "$(PCE_HAVE_NASM)" "1"
BIN	:= ibmpc.rom
else
BIN	:=
endif

SDP	:= Makefile $(HDR) $(HDR_EXT)
BDP	:= Makefile $(OBJ) $(OBJ_EXT)


all: $(BIN)


clean:
	rm -f $(OBJ) $(BIN) *.lst


install:
	$(INSTALL) -d -m 755 $(datdir)/pce
	$(INSTALL) -m 644 $(BIN) $(datdir)/pce

cmp:
	fcmp $(topdir)/contrib/bios/ibmpc.cmp ibmpc.rom > ibmpc.diff


ibmpc.rom: $(OBJ)
	cat pce.bin basic.bin bios.bin > $@



%.bin: %.asm
	$(NASM) -I$(reldir)/src -f bin -l $*.lst -o $@ $<


pce.bin:	pce.asm
bios.bin:	bios.asm
basic.bin:	basic.asm
